---
Название: Принципы Юнит-Тестирования
Автор: Хориков Владимир
Страниц: 320
Добавлена в базу: 11.06.2024 в 13:56
Прочитана: true
Начал читать: 2024-07-01
Закончил читать: 2024-07-18
Тип: "[[Книга]]"
---
## Причина добавления

Хориков крутой дядька с отличным [блогом](https://enterprisecraftsmanship.com/posts), его книга давно лежит в плане на чтение. Читаем в [[Ботаним]] сейчас, ура-ура:)

## Рецензия

Это книга, которую я могу смело рекомендовать всем разработчикам. Мало кто пишет тесты, еще меньше тех, кто пишет хорошие тесты — книга как раз об этом, как писать эффективные юнит и интеграционные тесты, какими свойствами они обладают и тд. Отличный материал.

Для лучшего усвоения стоит читать после знакомства с гексагональной/чистой архитектурой, так как качественное тестирование и качественный код связаны, книга рассказывает и о теме архитектуры, но в целом уже подразумевая, что читатель с этой темой знаком. Можно порекомендовать прочесть Чистую архитектуру Мартина и возможно Паттерны разработки на Python Персиваля предварительно, чтобы лучше понять архитектурные темы, затронутые в книге Хорикова. Хотя, возможно, и так всё понятно будет:)

Материал — огонь!

## Главное

### Глава 1

Цель юнит-тестирования — обеспечение стабильного роста проекта. Снижение энтропии, защита от регрессий.

Метрика branch coverage лучше, чем code coverage (которая учитывает только строки кода). Но обе метрики хороший негативный показатель (<60% кода покрыто тестами — плохо), но плохой позитивный (большое покрытие ничего не говорит о качестве тестов).

Юнит-тесты должны быть интегрированы в цикл разработки, в идеале должны запускаться при каждом минимальном изменении кода.

Хорошие тесты проверяют только максимально важные и сложные части, дают максимальную защиту от багов с минимальными затратами на сопровождение. Остальные тесты — удаляем. Тесты, как и любой другой код — обязательства, а не актив.

### Глава 2

AAA — arrange, act, assert. Структура теста.

SUT — System Under Test, хороший нейминг для тестируемой системы. 

В классической школе юнит — единица поведения. Может задействовать много кода, больше, чем одна функция или один класс. Юнит изолируется только от совместных коллаборантов (мешающих изолировать тесты друг от друга), однако на практике надо доменную логику покрывать юнит-тестами и у них нет коллаборантов, а потому и моки им не нужны.

Тесты проверяют не единицы кода, а единицы поведения, имеющие ценность для бизнеса.

Юнит-тест:

1. проверяет одну единицу поведения
2. делает это быстро
3. изолированно от других тестов

Любой тест, не отвечающий любому из трех условий — интеграционный. Сквозной тест это его подмножество.

### Глава 3

Не используй `if` в тестах, любых. Если нужен `if` — тест проверяет слишком много, разбей на несколько.

Избегай секций Act из нескольких строк. Если это нужно — плохой API у SUT, недостаток инкапсуляции.

Каждый тест должен рассказывать историю, факт. Тест упал — значит, факт перестал выполняться.

Не переиспользуй данные между тестами. Это создаёт ненужную связность между тестами. Создай методы-хелперы, которые по входным аргументам создают нужные объекты.

Не используй для подготовки тестовых данных конструктор — это и связность, и ухудшает читаемость тестов.

Название метода-теста — осмысленное, в форме факта, без имени тестируемого метода — тестим не его, а поведение. Например, `delivery_with_a_past_date_is_invalid()`.

>[!question] Посмотри
>Аналог Fluent Assertions для Python


### Глава 4
### Глава 5
### Глава 6
### Глава 7
### Глава 8
### Глава 9
### Глава 10
### Глава 11
