Поговорим сегодня о том как нам наш локально развернутый веб-сервис расшарить в интернет.


Для чего?

- telegram web hook
- какие-то хуки систем оплаты для development среды, чтобы система интернет-эквайринга уведомляла нас о статусе тестового платежа
- просто кому-то что по-быстрому показать, своим коллегам или заказчику, например, не поднимая полноценный удалённый сервер
- сценариев много и только ваша фантазия может вас тут ограничивать:)

## Запустим локальное веб-приложение

Это может быть на веб-сервер, который крутит наше веб-приложение, или приложение для telegram-бота, или что угодно. Я запущу просто для демонстрации встроенный веб-сервер в Python, который позволяет через веб-интерфейс получить доступ к какой-то директории на компьютере:

```bash
python3.12 -m http.server
Serving HTTP on :: port 8000 (http://[::]:8000/) ...
```

Обратите внимание на IP — так показывается IPv6 `[::]`, это адрес из всех нулей, то есть `0000:0000:0000:0000:0000:0000:0000:0000`. Это означает, что сервер прослушивает все сетевые интерфейсы.

Это доступно сейчас, конечно, только с локального компьютера — если у нас локальный компьютер без белого IP, если у нас не пробрасываются порты из нашего домашнего роутера и тд. В общем случае можно настроить доступ к локально развернутому веб-ресурсу и без отдельных сервис — но мне хочется показать лайтовый вариант, который можно быстро начать использовать и для которого не надо покупать белый IP или настраивать системы динамического DNS.

Причем эти сервисы, должны работать в том числе если вы за NAT'ом, у вас сложная конфигурация сети и тд.

И, кстати, можно сделать через эти сервисы ваш старый android смартфон полноценным веб-сервером. Я вам покажу, как за несколько секунд запустить на телефоне сервер, который будет доступен по всему миру в интернете. А, а, круто? Сейчас всё покажу.

>[!info] Интеграция
>А ещё, если вам нравится прокачиваться в своей профессии, то я хочу позвать вас на первую техническую конференцию от AvitoTech —  Avito All Day Long. Целый день крутейших докладов, о том, кто и как создаёт сервис, которым, по сути, пользуется каждый второй житель России.
>
>Причём, конечно, речь не только о докладах — это отличная возможность пообщаться со специалистами, понетворкать, сыграть в квиз и остаться с ними на афтепати.
>
>В программе доклады и дискуссии по трендам индустрии: коллеги поделятся опытом и решениями, которые вы сможете использовать для себя. Как по хардам (платформенные инструменты, Low Code (лоу коуд) и Backend Driven UI (бэкенд дривен ю ай), MLOps (ЭмЭлОпс) с нуля), так и по софтам (как правильных формулировать вопросов команде и самому себе, как решать конфликты продактов и тимлидов и так далее).
>
>А ещё можно пощупать технологические продукты теха — Emcee (**Э**мси), AvitoPlato (АвитоПлато) и Trisigma (ТриСигма). На конфе будут представлены демо-станции, где у вас будет шанс затестить решения, которые ещё не имеют аналогов на рынке.
>
>Avito All Day Long пройдёт 20 июля в Центре событий РБК (Москва), а также будет трансляция на ютуб — ссылки в описании, подпишитесь на уведомления, чтобы не забыть. А кто будет в Москве — регистрируйтесь и приходите в офлайн, я буду офлайн. До встречи!
>

Ну а мы возвращаемся к способам расшарить локальный веб-сервис в интернет!

## ngrok

Это возможно самый популярный способ расшарить локалхост в интернет, в минимальной версии ngrok работает бесплатно, причём сейчас её возможностей в бесплатной версии больше, чем было раньше.

Установка: https://ngrok.com/download

```bash
arch -arm64 brew install ngrok/ngrok/ngrok

ngrok config add-authtoken <token>

ngrok http http://localhost:8000
# https://add1-31-172-72-21.ngrok-free.app

# CTRL+C
ngrok http http://localhost:8000
# another domain
```

Чтобы получить статичный домен https://dashboard.ngrok.com/cloud-edge/domains

```bash
ngrok http --domain=hip-lynx-explicitly.ngrok-free.app 8000
# open in Chrome https://hip-lynx-explicitly.ngrok-free.app/
```

Ура-ура!

У нас есть статичный домен, с которым мы можем запускать наш локальный сервис, и даже работает HTTPS. Здорово!

Можете таким образом раздавать файлы со своего компьютера:) Хотя возможно и скорее всего у ngrok для бесплатного использования есть ограничения по трафику и скорости.

>[!info]  Хотя
> ... это всё-таки коммерческая компания, возможно ngrok перестанет работать для российских IP или ещё что-то. Рассмотрим и другие варианты, опенсорсные и некоммерческие.

## localtunnel

Это бесплатное и опенсорсное решение, всё как мы любим. 

```bash
npm install -g localtunnel
lt --port 8000 --subdomain wow-my-server
# https://wow-my-server.loca.lt

# password is here https://loca.lt/mytunnelpassword
# or with curl
```

Как видим, HTTPS поддерживается, и статичный домен тоже. Крутяк!

Кто-то говорил мне, что у него `localtunnel` не работал в его сетевой конфигурации — подтвердить это я не могу, у меня всё работает как надо.

## Serveo

Ещё одно кайфовое бесплатное решение — [Serveo](https://serveo.net/). Он работает с SSH и даже ничего устанавливать не нужно гыгы:)

```bash
ssh -R 80:localhost:8000 serveo.net
# https://d573dfb540acbf3a7b5f5353e038348a.serveo.net
```

Как видите, HTTPS тоже работает. Статический домен тоже можно сделать, для этого надо зарегистрировать свой SSH публичный ключ:

```bash
ssh -R wow-my-server:80:localhost:8000 serveo.net
# переходим по ссылке в гугл или github, и снова запускаем команду

ssh -R wow-my-server:80:localhost:8000 serveo.net
# https://wow-my-server.serveo.net/
```

Отличнооо!

## Expose

[Это](https://github.com/beyondcode/expose) бесплатный опенсорсный сервис, написанный на PHP — внезапно! Так и написано — ngrok альтернатива. Однако они за кастомный поддомен хотят денег, а бесплатно дают только рандомный субдомен, что не всегда удобно и сразу много сценариев использования отрубает. Однако если для вас это не проблема — можете попробовать.

## Tunnelto

https://tunnelto.dev/ — тоже дают свой поддомен за 2 бакса в месяц.

## Termux

Можно сделать это разными способами, конечно, например, с помощью VPN-сети, но можно и без VPN с теми инструментами, о которых мы здесь поговорим. Тогда этим веб-ресурсом можно будет пользоваться всем без необходимости подключать VPN.

В Termux ==покажи== запустил сервер, запустил сервис для его публикации в интернет — готово.


