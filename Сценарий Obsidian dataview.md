# Название

**Как назвать видос?**

Obsidian + dataview + js — базы данных и произвольный UI в заметках!

# Сценарий

Здоров, котаны, покажу вам, как сделать вот такие штуки в Obsidian. Это база данных книг. Что я читаю сейчас, прочитанное в 2025м, прочитанное в 2024м, все книг. По каждой книге есть массив информации — автор, название, категория, количество страниц, прогресс чтения, обложка. И всю эту информацию можно использовать так, как вы посчитаете нужным, с любым анализом, любой визуализацией, потому что всё, что вы видите создано самостоятельно со встроенными возможностями obsidian и всего с одним плагином dataview, который даёт возможность получать удобный доступ к данным заметок.

Видео побито по главам, можете переходить к интересующей вас части, а я начну по порядку.

Кто не в курсе, Obsidian это программа для ведения заметок, у меня есть полуторачасовое видео о ней, если пропустили, обязательно посмотрите! Если коротко, то Obsidian даёт возможность удобно просматривать и редактировать обычные текстовые файлы, которые хранятся на вашем компьютере. Вы этими файлами и всей информацией в них владеете и можете использовать их как угодно, в том числе в любой другой программе.

Помимо обычной текстовой информации в текстовые документы можно вставлять метаданные, то есть данные о данных, например, можно создать обычную текстовую заметку по книге и вставить в неё в специальном формате, который называется yaml, конкретные поля по этой книге — автор, название, категории, количество страниц, прогресс чтения и так далее. И при необходимости obsidian и плагин dataview позволяют эти метаданные использовать наравне с обычными данными файла, например, названием файла, размером, временем создания и редактирования.

И я дальше покажу, как с этим работать, но начать я хочу с небольшого отступления. В комментариях в Telegram многие пишут, что они отказались от Obsidian, потому что тут много возможностей и непонятно как это всё использовать и это демотивирует. Есть какая-то методология цеттелькастен, какие-то инструменты в Obsidian, какие-то плагины, со всем этим надо разбираться, всё это надо настраивать... Демотивирует. Отталкивает. Вроде простая тема — ведение заметок, а тут что-то вокруг неё накручивают какие-то звездолёты. Такое отношение к Obsidian было и у меня, однако что я вам хочу сказать.

Важно задать себе вопрос — для чего мне заметки? Отвечу для себя — заметки мне нужны, чтобы а) отрефлексировать какие-то мысли в момент написания заметки, и это очень важно, и б) чтобы иметь возможность вернуться к этим мыслям впоследствии, что-то сохранить на будущее, выгрузить это из мозга в компьютер.

Внимание вопрос — нужно ли для достижения этих целей что-то сложное? Какой-то цеттелькастен, какие-то плагины, настройки, с которыми надо разбираться? Нет, конечно. Это всё вообще не нужно. Я просто пишу заметки, просто сохраняю информацию, всё.

У меня стоит стандартная тема Obsidian, и долгое время стоял всего один плагин — git, для синхронизации заметок с git-репозиторием. Кстати, мои заметки доступны публично в github (добавь QR), если вам интересно, особо конфиденциальной информации там нет, всё в порядке.

И вот буквально несколько дней добавился плагин dataview, потому что мне захотелось украсить свою базу знаний по книжкам. Я читаю книги и мне хочется вести список прочитанного, список того, что сейчас читаю, и чтобы наглядно было это всё видно.

Это обязательно? Вообще нет. Я просто пишу заметки и это самое главное. Я даже не связываю эти заметки друг с другом, не пользуюсь графом связей заметок, мне всё это не нужно. Я просто пишу заметки и получаю возможность к ним вернуться потом через поиск или избранное, всё. Это основное, что нужно всем, кто работает с заметками, и этого достаточно.

Не надо себя как-то корить за то, что вы не углубляетесь в Obsidian. Когда вам захочется, вы углубитесь, в том числе и с помощью моих видео. Основа и суть в самих заметках, а не свистоперделках вокруг них. Поэтому просто ведите заметки и получайте от этого удовольствие и пользу и не парьтесь.

А если вы уже пришли к тому, что вам интересно, как можно сделать то, что я вам показал, и вы хотите с этим попрактиковаться — то добро пожаловать, давайте сделаем это!

# Установка dataview

Чтобы установить плагин Dataview в Obsidian, открываем настройки Obsidian с `ctrl`+`,` на винде или с `cmd`+`,` на маке. Идём в Community Plugins, включаем их (Turn on Community plugins), если ещё не включали, жмём Browse и открываем плагин Dataview, устанавливаем (Install) и активируем (enable) его. Переходим в настройки плагина options. Включаем Enable JavaScript Queries и Enable inline JavaScript Queries.

На этом установка закончена и можно переходить к использованию!

# Практикуемся с dataview

Создаём новую заметку. Создадим блок кода с синтаксисом dataview:

```
table
```

Вывелись все заметки в нашей базе, то есть в нашем vault, то есть в директории с заметками, открытой в Obsidian. Это визуализация таблицей, есть ещё визуализация списком:

```
list
```

Ещё есть визуализация календаря и todo листа, о них можете посмотреть в документации.

Итак, мы можем вывести все заметки в виде таблицы или списка. Забавно, но не более того.

Выведем таблицу, добавив имя файла отдельной колонкой, а также дату изменения файла:

```
table file.name, file.ctime
```

Ограничим вывод 3 записями:

```
table file.name, file.ctime
limit 10
```

Отсортируем по дате изменения и выведем 3 последних отредактированных файла:

```
table file.name, file.ctime
sort file.ctime desc
limit 10
```

Изменим порядок сортировки, достанем 10 самых старых отредактированных файла:

```
table file.name, file.ctime
sort file.ctime asc
limit 10
```

Здесь же можно выбирать метаданные, например, авторов книг:

```
table file.name, Автор
limit 100
```

 То есть парсятся данные из текстовых файлов, тот самый yaml, и выбираются поля, которые указаны там. Для файлов, в которых нет метаданных или не заполнено нужное поле, для него в выходной таблице мы видим прочерк.

Уберём записи без проставленного поля Автор:

```
table file.name, Автор
where Автор
limit 100
```

А если нужен конкретный автор?

```
table file.name, Автор
where Автор="Хононов Влад"
limit 100
```

Отлично!

Можно выбирать текстовые документы из директории, по тегам, по значениям полей, можно выбирать заметки, на которые ссылается нужная заметка, или которая наоборот ссылается на какую-то заметку и так далее.

Кстати, как я добавляю книги? С помощью шаблона. В настройках у меня включен core-плагин templates, и в настройках плагина указана директория для хранения шаблонов `templates`. В этой директории есть «Шаблон книги». Здесь мы видим набор полей, который можно будет заполнять по каждой книге, а также два заголовка «Причина добавления книги» и «Рецензия». Для меня это необходимая информация, я хочу знать, откуда я узнал об этой книге, например, когда я добавляю её в базу данных, и хочу знать резюме после её прочтения, чтобы можно было быстро эту информацию освежить.

Теперь вернёмся к выборкам.

Есть в целом и другие плагины помимо dataview, которые делают возможным делать выборки заметок, сортировать, группировать их и так далее. Tcnm даже те, которые реализуют SQL-синтаксис, например, плагин SQL Seal.

Но мне понравился именно dataview возможностью писать код на JS и формировать любой вывод.

Давайте сначала достанем все книги с помощью синтаксиса простого dataview, без JS:

```
table file.name, Автор, Страниц, закончил-читать
where Тип=[[Книга]] and file.folder!="templates"
```
Мы фильтруем по полю Тип и убираем заметки из директории шаблонов.

Как это переписать на JS?

```
let book_pages = dv.pages("").where(page => {
    if (page["Тип"] && page["Тип"].path == "types/Книга.md" && page.file.folder != "templates") {
      return page;
    }
})

dv.table(
    ["Название", "Автор", "Страниц", "Прочитана"],
    book_pages.map(p => {
		const authors = p.Автор.split(",").map(el => el.trim()).join("<br />");
        return [
            dv.fileLink(p.file.path, false, p.Название),
            authors,
            p.Страниц,
            p["Закончил читать"] !== null ? p["Закончил читать"] :
            ""
        ];
    })
);
```

Отлично!

Давайте выведем индекс каждой книге, причём чтобы вверху был последний индекс, а внизу индекс 1. И сортировка чтобы такая, чтобы последняя прочитанная была вверху:

```
let booksCount = 0;
let book_pages = dv.pages("").where(page => {
    if (page["Тип"] && page["Тип"].path == "types/Книга.md" && page.file.folder != "templates") {
      booksCount++;
      return page;
    }
}).sort(p => p["Закончил читать"], "desc");

const MAX_BOOK_NAME_LENGTH = 50;
let index = booksCount + 1;

dv.table(
    ["", "Название", "Автор", "Страниц", "Прочитана"],
    book_pages.map(p => {
		const authors = p.Автор.split(",").map(el => el.trim()).join("<br />");
        return [
			--index,
            dv.fileLink(p.file.path, false, p.Название),
            authors,
            p.Страниц,
            p["Закончил читать"] !== null ? p["Закончил читать"] :
            ""
        ];
    })
);
```

Сократим название книги:

```
let booksCount = 0;
let book_pages = dv.pages("").where(page => {
    if (page["Тип"] && page["Тип"].path == "types/Книга.md" && page.file.folder != "templates") {
      booksCount++;
      return page;
    }
}).sort(p => p["Закончил читать"], "desc");

const MAX_BOOK_NAME_LENGTH = 50;
let index = booksCount + 1;

dv.table(
    ["", "Название", "Автор", "Страниц", "Прочитана"],
    book_pages.map(p => {
        const shortName = p.Название.length > MAX_BOOK_NAME_LENGTH  
            ? p.Название.substring(0, MAX_BOOK_NAME_LENGTH) + "..." 
            : p.Название;
		const authors = p.Автор.split(",").map(el => el.trim()).join("<br />");
        return [
			--index,
            dv.fileLink(p.file.path, false, shortName),
            authors,
            p.Страниц,
            p["Закончил читать"] !== null ? p["Закончил читать"] :
            ""
        ];
    })
);
```

Отличнооо!

Но это довольно скучно. Я хочу свою визуализацию. Чтобы на табличка выводилась, а карточки по книгам. Как этого добиться? Собственно, элементарно — мы же понимаем, что обсидиан это просто веб-приложение, запущенное в браузере электрон. Открываем панель разработчика, и тут видим все элементы, можем смотреть, как что сделано и работает.

Бахнем карточки!




--- 

хотите вынести информацию по книгам прочитанным в 2024м в отдельную заметку? Пожалуйста. Хотите сделать разные визуализации? Пожалуйста.

Хотите вообще сделать что-то сложное? Снова пожалуйста — вам доступна вся мощь фронтенд-технологий, все JavaScript-библиотеки. Не надо ничего учить нового. Ну, конечно, CSS и JS знать надо, но кто их сейчас не знает:) Если вдруг не знаете, приходите на Хардкорную веб-разработку ко мне, научитесь.

Кайфовый инструмент, просто кайфовый! Пользуйтесь:)

---

дисклеймер: просто ведите заметки. Не упарывайтесь по началу во все эти связи, какие-то до фига умные плагины и так далее. Просто записывайте мысли и то, что вам может пригодиться, ВСЁ. Вот просто ВСЁ, ничего больше не надо. Не усложняйте себе жизнь, вам это не надо пока что, а возможно и никогда не надо будет.

А то в комментах я вижу, что многих демотивирует, что тут можно в obsidian или других подобных программах, накрутить комбайн, и люди вместо ведения заметок погружаются в дебри комбайнов и в итоге ни к чему не приходят. Не надо. Задайте себе вопрос зачем вы ведете заметки? Я для себя отвечаю так: ... (см телеграм).

И к dataview я пришел недавно, недавно стал использовать, фактически несколько дней назад, разобрался и мне захотелось вам это рассказать.


# Что показать

10 самых больших заметок:

```dataview
table WITHOUT ID file.name, file.size, link(file.link, "open") as f
sort file.size desc
limit 10
```

Убрать директорию минусом:

```
Table file.ctime as created
From #todevelop and -"008 TEMPLATES"
sort ASCE
Limit 20
```

---

Настройка CSS для дефолтной темы. Настройки Obsidian, Appearance -> CSS Snippets, включить сниппет, который лежит в `.obsidian/snippets/widepage.css`.

# Материалы

- playlist на ютубе про dataview
- https://habr.com/ru/articles/710356/ — статья про dataview
- https://gennbooth.ru/mysli?entry=1002
- https://readmedium.com/2a275c274936 (см как карточки делает, картинки выводит)
- https://agileadam.com/2022/07/using-dataview-with-charts-in-obsidian/
- https://www.youtube.com/watch?v=G8eOF61wmzI
- https://obsidian.rocks/dataview-in-obsidian-a-beginners-guide/
- https://www.obsidianstats.com/plugins/dataview
- https://www.youtube.com/watch?v=66iB9hNHYQI — куда войти
- https://obsidian.rocks/dataview-in-obsidian-a-beginners-guide/
- http://maxcherepitsa.ru/blog/dataview-obsidian/
- https://cassidoo.co/post/obsidian-dataview/