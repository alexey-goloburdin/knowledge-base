- Как PostgreSQL хранит данные. Как смотреть EXPLAIN analyze buffers, сколько считано страниц. В OLTP считывать можно всего неск страниц (см коммент к видосу или посту про связь 1-1), остальное OLTP.
- Связь 1-1
- Нормализация данных и материализованные вьюшки
- Сразу писать эффективные запросы вместо написания как идёт и надежды оптимизировать впоследствии
- Писать декларативные запросы вместо императивных (императивные часто с подзапросами, декларативные просто с join)
- Алгоритмы доступа к данным
- Алгоритмы соединения таблиц
- Короткие и длинные запросы и как их оптимизировать
- Индексы
	- Селективность индекса влияет на то, будет ли использован индекс
	- Index only метод доступа
	- Порядок колонок в индексе и запросе имеет значение (сделай пример)
	- Виды индексов
	- Функциональные индексы
	- Частичные индексы
- Как читать Explain Analyze
- Где смотреть медленные запросы
- Какие параметры влияют на производительность постгреса

Данные хранятся в файлах. Файлы организованы в страницы размером как правило 8КБ. Страница это минимальная единица, которую можно считать с диска и которую можно записать на диск в постгресе. То есть постгрес не умеет считать одну строку из таблицы. Он умеет считать только одну страницу, в которой находится одна конкретная строка. Но помимо этой строки на странице могут быть и другие строки.

Стоимость запроса — это количество тактов процессора и количество операций ввода-вывода.

Как нам достать результаты SQL-запроса `select * from table where field='value'`? Полным сканированием таблицы. Но это медленно. Есть ли способ лучше?

Данные, которые хранятся в таблице, лежат там как? Упорядоченно или нет? Хранятся неупорядоченно, в куче. Где-то, на какой-то странице есть свободное место — мы туда новую строку и вставляем.

---
https://rutube.ru/video/80851eb98742fac5a7b42325edaf5a69/?playlist=452238
13:17

какие-то узлы (nested loop) могут отдавать наверх данные сразу по мере их появления, какие-то только целиком (sort)

планировщик может рассматривать разные планы — использовать разные методы доступа к данным, разным образом соединять таблицы можно, разный порядок соединения таблиц и тд. Чтобы посчитать стоимость плана, которая строится из стоимости каждого узла, надо понимать, сколько строк будет обработано на каждом узле, а для этого нужна статистика

Селективность — доля выбираемых строк, от 0 до 1, 1 если выбираются все строки
Кардинальность — итоговое количество строк, которое выбирается

Стоимость плана — количество тактов процессора и количество IO-операций, то есть операций считывания и записи страниц

>[!info] Цифры в explain
> cost 0..4772. Стоимость начала выполнения работы — то есть стоимость подготовительных работ (тут они не нужны), и второе число это стоимость выполнения всей работы
> rows — количество строк
> width в eplain — размер 1 строки в байтах

