---
cssclasses:
  - wide-85
---
# Читаю сейчас (`$= dv.pages("").where(page => {if (page["Тип"] && page["Тип"].path == "types/Книга.md" && page.file.folder != "templates" && !page["Закончил читать"] && page["Начал читать"]) {return page;}}).length`)

```dataviewjs
// import code
eval(
    (await app.vault.read(app.vault.getAbstractFileByPath("dataviewjs/books.md")))
    .replace("```js", "").replace("```", "")
);

const booksFiles = window.books.getBooks()
    .where(page => {
        if (!page["Закончил читать"] && page["Начал читать"]) {return page;}
    })
    .sort(p => p["Начал читать"], "desc");

dv.el("div", window.books.renderBooks(booksFiles, book => `начал ${window.books.formatDate(book["Начал читать"])}<br>`), {cls: "books"});
```

>[!info] TODO
>- добавь в базу книги по съёмке https://www.youtube.com/watch?v=EHKzUhJ29l8
>- дату добавления, начала чтения и конца чтения проверь по всем книгам, чтобы это была корректно сортируемая дата
>- добавить поле «Формат» (бумажная, электронная)

# Прочитанное в 2025

```dataviewjs
let booksCount = 0;

let bookPages = dv.pages("").where(page => {
    if (page["Тип"] && page["Тип"].path == "types/Книга.md" && page.file.folder != "templates" && page["Закончил читать"] && new Date(page["Закончил читать"].ts).getFullYear() === 2025) {
	  booksCount++;
      return page;
    }
}).sort(p => p["Закончил читать"], "desc");

const MAX_BOOK_NAME_LENGTH = 50;
let index = booksCount + 1;

dv.table(
    ["", "Название", "Автор", "Страниц", "Прочитал"],
    bookPages.map(p => {
        const shortName = p.Название.length > MAX_BOOK_NAME_LENGTH  
            ? p.Название.substring(0, MAX_BOOK_NAME_LENGTH) + "..." 
            : p.Название;
		const authors = p.Автор.split(",").map(el => el.trim()).join("<br />");
        return [
			--index,
            dv.fileLink(p.file.path, false, shortName),
            authors,
            p.Страниц,
            p["Закончил читать"] !== null ? p["Закончил читать"] :
            ""
        ];
    })
);
```

- [[Все книги карточками]] (`$= dv.pages("").where(page => {if (page["Тип"] && page["Тип"].path == "types/Книга.md" && !["templates", "templater"].includes(page.file.folder)) {return page;}}).length`)
- [[Все книги таблицей]]

